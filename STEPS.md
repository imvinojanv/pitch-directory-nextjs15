# Next.js Theory

## Server Side Strategies

### Static Site Generation (SSG):

-   A technique where HTML pages are generated at build time, this means that the content is created when you deploy your site, not when a user requests it.
-   It's extremely fast and can be served from a CDN, but It's not suitable for websites that need frequently updated content.
-   By default, Next.js uses a static_rendering_strategy, your results is cached and delivered through a CDN network.
    Eg: Blogs, Documentations, or Marketing pages

### Incremental Site Regeneration (ISR):

-   It's an extension of SSG that allows you to update static content after you've built your site, this means that it'll create static pages and build time behaving like SSG and after some time has passed it'll create or update those static pages once again after you've deployed your site.
-   It's combined the benefits of static generation with the ability to refresh or update content

1. **Time-based revalidation:**
    - You can revalidate your entire page after some time by simply exporting a variable called `revalidate` and set it equal to the number of seconds of when you want to revalidate
    ```javascript
    export const revalidate = 3600;
    ```
    - Revalidate the request after some time:
    ```javascript
    export default async function Page() {
        const data = await fetch("https://api.path.com/blog", {
            next: { revalidate: 3600 },
        });
        const posts = await data.json();
    }
    ```
2. **On-demand revalidation with `revalidatePath` and `revalidateTag`**
   (check the Next.js documentation for this...)

### Server Side Rendering (SSR):

-   It generate the HTML for a page on the server in response to a user's request, this means that the contemt is created dynamically for each user request, and not only for each deployment.
-   It's slower than SSG and puts more load on the server, but you always have up-to-date content
    Eg: Real-time data, Highly dynamic content pages

### Partial Prerendering (PPR):

-   It combines static and dynamic rendering that allows you to render a static shell of a page while streaming dynamic content.
-   PPR is allow for a hybrid approach within a single page.
-   During build time Next.js generates a static shell of the pages. This shell includes the layout and any static parts of the page in the form of components, this static shell includes placeholders for dynamic contents. We do it wrapping dynamic components in a `suspense` tage.
-   When a user requests the page the static shell is served immediately and then the dynamic content is streamed in as it becomes available.

## Search Engine Optimizations (SEO)

### Static metadata:

```javascript
export const metadata: Metadata = {
    title: "Create Next App",
    description: "Generated by create next app",
};
```

### Dynamic metadata:

```javascript
export async function generateMetadata({ params }) {
    const { id } = params;
    const resource = await getResourceBtId(id);

    const title = "Metadata Title";
    const description = "Metadata desc";
    // Other metadata

    return {
        title,
        description,
        other: {
            "og:titte": titte,
            "og : description": description,
            "og : image": resource.image,
            "twitter : title ": titte,
            "twitter : image": resource.image,
            "twitter : description ": description,
        },
    };
}

export default function HomePage({ params, searchParams }) {
    // ...
}
```

### File-based metadata:

You can put files like `robot text`, `sitemap`, `favicon`, `open graph images`, or `other site icons` directly inside the **`app`** folder. And Next.js will automatically detect and generate corresponding meta tags.
Add the files with the right names:

-   `favicon.ico`
-   `icon.svg`
-   `opengraph-image.jpg`
-   `twitter-image.png`

# Development Steps

## Initial setup

-   Create a new Next.js app with **Turbopack**
-   Modify the `package.json` to comfortable with **React 19**:
    ```json
    {
        "packageManager": "npm@10.8.1",
        "overrides": {
            "react": "$react",
            "react-dom": "$react-dom"
        }
    }
    ```
    This will ensure that the latest versions of React are being used across all the packages in this project.

## Authentication with Auth.js (NextAuth)
-   Ref: [Auth.js Document](https://authjs.dev/getting-started/installation?framework=Next.js)
-   Install the NextAuth package:
    ```bash
    npm install next-auth@beta
    ```
-   Setup environment:
    ```bash
    npx auth secret
    ```
-   Configure:
    - `./auth.ts`
    ```typescript
    import NextAuth from "next-auth";
 
    export const { handlers, signIn, signOut, auth } = NextAuth({
        providers: [],
    });
    ```
    - `./app/api/auth/[...nextauth]/route.ts`
    ```typescript
    import { handlers } from "@/auth";

    export const { GET, POST } = handlers;
    ```
    - Skip the optional step to create a middleware

### GitHub Provider Authentication
-   **Creating an OAuth app**
    Go to the GitHub > Settings > Developer settings > OAuth Apps > New OAuth App
-   Copy and past the Client ID into our `.env` file
-   Generate new client secret and paste it as well
-   Update the `auth.js` configuration
-   Implement the the Navbar component with user authentication (`./components/navbar.tsx`)
-   Draw the structural diagram for the authentication flow (`./public/draw/auth.drawio`)

## Theming and Fonts
-   Update the `tailwind.config.ts`
-   Import custom fonts
-   Added some custom utility classes for styling in `./app/globals.css`
-   Install Shadcn UI
    ```bash
    npx shadcn@latest init
    ```